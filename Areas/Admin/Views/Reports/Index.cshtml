@model HealingInWriting.Models.Admin.ReportsDashboardViewModel

@{
    ViewData["Title"] = "Admin Reports";
}

<link rel="stylesheet" href="~/css/views/admin-reports.css" asp-append-version="true" />
<link rel="stylesheet" href="~/css/shared/search-bar.css" asp-append-version="true" />
<main>
    <div class="admin-reports">
        <!-- Search Bar Component -->
        <div class="search-bar">
            <div class="search-bar__filters-row">
                <div class="search-bar__input-container">
                    <svg class="search-bar__icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11 19C15.4183 19 19 15.4183 19 11C19 6.58172 15.4183 3 11 3C6.58172 3 3 6.58172 3 11C3 15.4183 6.58172 19 11 19Z" stroke="#6B7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        <path d="M21 21L16.65 16.65" stroke="#6B7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    <input type="text" class="search-bar__input" placeholder="Search..." />
                </div>

                <div class="search-bar__dropdown">
                    <span class="search-bar__dropdown-label">Any Location</span>
                    <svg class="search-bar__dropdown-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6 9L12 15L18 9" stroke="#6B7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </div>

                <div class="search-bar__dropdown">
                    <span class="search-bar__dropdown-label">Any Date</span>
                    <svg class="search-bar__dropdown-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6 9L12 15L18 9" stroke="#6B7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </div>

                <div class="search-bar__dropdown">
                    <span class="search-bar__dropdown-label">Any Tags</span>
                    <svg class="search-bar__dropdown-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6 9L12 15L18 9" stroke="#6B7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </div>

                <div class="search-bar__dropdown">
                    <span class="search-bar__dropdown-label">Newest</span>
                    <svg class="search-bar__dropdown-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6 9L12 15L18 9" stroke="#6B7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </div>

                <button class="search-bar__button">
                    <svg class="search-bar__button-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11 19C15.4183 19 19 15.4183 19 11C19 6.58172 15.4183 3 11 3C6.58172 3 3 6.58172 3 11C3 15.4183 6.58172 19 11 19Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        <path d="M21 21L16.65 16.65" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    <span class="search-bar__button-label">Search</span>
                </button>
            </div>
        </div>

        <!-- Event Attendance Chart -->
        <div class="admin-reports__card">
            <h3 class="admin-reports__card-title">Event Attendance</h3>
            <div class="admin-reports__chart">
                <div class="admin-reports__chart-labels">
                    @foreach (var item in Model.EventAttendance)
                    {
                        <span class="admin-reports__chart-label">@item.EventTitle</span>
                    }
                </div>
                <div class="admin-reports__chart-area">
                    <div class="admin-reports__chart-grid">
                        @for (int i = 0; i <= 10; i++)
                        {
                            <div class="admin-reports__chart-grid-line"></div>
                        }
                    </div>
                    <div class="admin-reports__chart-bars">
                        @foreach (var item in Model.EventAttendance)
                        {
                            <div class="admin-reports__chart-bar"
                                 style="--attendance-value: @item.AttendanceCount;"
                                 data-value="@item.AttendanceCount"
                                 title="@item.EventTitle: @item.AttendanceCount attendees"></div>
                        }
                    </div>
                    <div class="admin-reports__chart-x-axis">
                        @for (int i = 0; i <= 10; i++)
                        {
                            <span class="admin-reports__chart-x-label">@(i * 25)</span>
                        }
                    </div>
                </div>
            </div>
        </div>

        <!-- Story Submissions Section -->
        @* <div class="admin-reports__card">
            <h3 class="admin-reports__submissions-header">Story Submissions</h3>
            <div class="admin-reports__stats-row">
                <div class="admin-reports__stat-card admin-reports__stat-card--pending">
                    <p class="admin-reports__stat-number admin-reports__stat-number--pending">@Model.StoryPendingCount</p>
                    <p class="admin-reports__stat-label">Pending</p>
                </div>
                <div class="admin-reports__stat-card admin-reports__stat-card--published">
                    <p class="admin-reports__stat-number admin-reports__stat-number--published">@Model.StoryPublishedCount</p>
                    <p class="admin-reports__stat-label">Published</p>
                </div>
                <div class="admin-reports__stat-card admin-reports__stat-card--drafts">
                    <p class="admin-reports__stat-number admin-reports__stat-number--drafts">@Model.StoryDraftCount</p>
                    <p class="admin-reports__stat-label">Drafts</p>
                </div>
            </div>
            <div class="admin-reports__table-wrapper admin-reports__table-wrapper--scrollable">
                <table class="admin-reports__table">
                    <thead class="admin-reports__table-head">
                        <tr>
                            <th class="admin-reports__table-header">Title</th>
                            <th class="admin-reports__table-header">Author</th>
                            <th class="admin-reports__table-header">Date</th>
                            <th class="admin-reports__table-header">Status</th>
                        </tr>
                    </thead>
                    <tbody class="admin-reports__table-body">
                        @foreach (var story in Model.RecentStories)
                        {
                            <tr class="admin-reports__table-row"
                                data-story-id="@story.StoryId"
                                data-status="@story.Status.ToString().ToLower()"
                                data-date="@story.CreatedAt.ToString("yyyy-MM-dd")">
                                <td class="admin-reports__table-cell admin-reports__table-cell--title">@story.Title</td>
                                <td class="admin-reports__table-cell">@story.AuthorName</td>
                                <td class="admin-reports__table-cell">@story.CreatedAt.ToString("MMM dd, yyyy")</td>
                                <td class="admin-reports__table-cell">
                                    <span class="admin-reports__status-badge admin-reports__status-badge--@story.Status.ToString().ToLower()">
                                        @story.Status
                                    </span>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div> *@

        <!-- Book Inventory Snapshot -->
        <div class="admin-reports__card">
            <h3 class="admin-reports__card-title">Book Inventory Snapshot</h3>
            <div class="admin-reports__table-wrapper admin-reports__table-wrapper--scrollable">
                <table class="admin-reports__inventory-table">
                    <thead>
                        <tr>
                            <th class="admin-reports__inventory-header">Category</th>
                            <th class="admin-reports__inventory-header">Current Stock</th>
                            <th class="admin-reports__inventory-header">Status</th>
                        </tr>
                    </thead>
                    <tbody class="admin-reports__inventory-body">
                        @foreach (var row in Model.BookInventoryByCategory)
                        {
                            var status = row.StockCount < 50 ? "critical"
                                : row.StockCount < 100 ? "low"
                                : "good";
                            <tr class="admin-reports__inventory-row"
                                data-category="@row.Category"
                                data-stock-count="@row.StockCount"
                                data-threshold-critical="50"
                                data-threshold-low="100">
                                <td class="admin-reports__inventory-cell">@row.Category</td>
                                <td class="admin-reports__inventory-cell">@row.StockCount</td>
                                <td class="admin-reports__inventory-cell">
                                    <span class="admin-reports__status-badge admin-reports__status-badge--@status">
                                        @status.First().ToString().ToUpper()@status.Substring(1)
                                    </span>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</main>
