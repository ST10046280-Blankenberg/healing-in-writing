@model HealingInWriting.Models.Volunteer.VolunteerHourFilterViewModel
@using HealingInWriting.Domain.Volunteers

@{
    ViewData["Title"] = "Hours Approval";
    var statusOptions = ViewBag.StatusOptions as string[] ?? Array.Empty<string>();
}

<link rel="stylesheet" href="~/css/shared/admin-header.css" asp-append-version="true" />
<link rel="stylesheet" href="~/css/views/hours-approval.css" asp-append-version="true" />
<link rel="stylesheet" href="~/css/shared/search-bar.css" asp-append-version="true" />
<script src="~/js/hours-approval-modal.js" asp-append-version="true" defer></script>

<main class="hours-approval">
    <header class="admin-header fade-in-up">
        <div class="admin-header__content">
            <div class="admin-header__text">
                <h1 class="admin-header__title">Volunteer Hours Approvals</h1>
                <p class="admin-header__subtitle">Review and approve submitted volunteer hours.</p>
            </div>
        </div>
    </header>

    @if (TempData["Success"] != null)
    {
        <div class="alert alert-success alert-dismissible fade show hours-approval__alert" role="alert">
            @TempData["Success"]
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }

    @if (TempData["Error"] != null)
    {
        <div class="alert alert-danger alert-dismissible fade show hours-approval__alert" role="alert">
            @TempData["Error"]
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }

    <!-- Filter Bar -->
    <form method="get" asp-action="Index" class="search-bar">
        <div class="search-bar__input-container">
            <input class="search-bar__input" type="text" name="search" placeholder="Search..." value="@Model.Search" />
        </div>
        <!-- Date Range -->
        <input type="date" name="startDate" class="search-bar__dropdown"
            value="@(Model.StartDate?.ToString("yyyy-MM-dd") ?? "")" />
        <span>to</span>
        <input type="date" name="endDate" class="search-bar__dropdown"
            value="@(Model.EndDate?.ToString("yyyy-MM-dd") ?? "")" />
        <select name="status" class="search-bar__dropdown-">
            <option value="">Any Status</option>
            @foreach (var status in statusOptions)
            {
                var selected = Model.Status == status ? "selected" : null;
                <option value="@status" selected="@selected">@status</option>
            }
        </select>
        <select name="orderBy" class="search-bar__dropdown">
            @{
                var newestSelected = Model.OrderBy == "Newest" ? "selected" : null;
                var oldestSelected = Model.OrderBy == "Oldest" ? "selected" : null;
            }
            <option value="Newest" selected="@newestSelected">Newest</option>
            <option value="Oldest" selected="@oldestSelected">Oldest</option>
        </select>
        <button class="search-bar__button" type="submit">
            <span class="search-bar__button-label">Search</span>
        </button>
    </form>

    <!-- Table Section -->
    <div class="hours-approval__table-container fade-in-up delay-100">
        @await Html.PartialAsync("_HoursApprovalTable", Model.Results)
    </div>
</main>