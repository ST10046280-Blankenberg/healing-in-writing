@model HealingInWriting.Models.Books.BookInventoryListViewModel
@using HealingInWriting.Models.Shared

@{
    ViewData["Title"] = "Manage Books";
}

@section Scripts {
    <script src="~/js/admin-books-inventory.js"></script>
}
@section Styles {
    <link rel="stylesheet" href="~/css/shared/admin-header.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/shared/search-bar.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/views/manage-books.css" asp-append-version="true" />
}

<div class="manage-books">
    <!-- Header Section -->
    <header class="admin-header">
        <div class="admin-header__content">
            <div class="admin-header__text">
                <h1 class="admin-header__title">Manage Books</h1>
                <p class="admin-header__subtitle">Update inventory, edit book details, and manage visibility.</p>
            </div>
            <div class="admin-header__actions">
                @* TODO: Remove in production. *@
                <a href="@Url.Action("AddBook", "Books", new { area = "Admin" })" class="admin-header__action-btn">
                    <svg class="admin-header__action-icon" xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16" fill="none">
                        <path d="M7 1v14M1 8h12" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" />
                    </svg>
                    <span class="admin-header__action-label">Add New Book</span>
                </a>
                @* TODO: Remove in production. *@
                <a href="@Url.Action("SeedSampleData", "Books", new { area = "Admin" })"
                   class="admin-header__action-btn admin-header__action-btn--secondary"
                   style="background:#4B5563;"
                   onclick="return confirm('Seed sample data? This may take a moment.');">
                    <svg class="admin-header__action-icon" xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16" fill="none">
                        <rect x="2" y="2" width="10" height="12" rx="2" fill="#fff" stroke="#fff" stroke-width="2" />
                        <path d="M4 8h6M4 11h6" stroke="#4B5563" stroke-width="2" stroke-linecap="round" />
                    </svg>
                    <span class="admin-header__action-label">Seed Sample Data</span>
                </a>
            </div>
        </div>@* TODO: Remove in production. *@
    </header>

    <!-- Search Bar with AJAX Filter -->
    @{
        var searchConfig = new AdminSearchBarConfig
        {
            Controller = "Books",
            SearchPlaceholder = "Search books...",
            SearchInputName = "searchTerm",
            Dropdowns = new List<AdminFilterDropdown>
            {
                new()
                {
                    Name = "selectedCategory",
                    Label = "Any Category",
                    Options = Model.AvailableCategories.Select(c => new AdminDropdownOption
                    {
                        Value = c,
                        Text = c,
                        Selected = c == Model.SelectedCategory
                    }).ToList()
                },
                new()
                {
                    Name = "selectedAuthor",
                    Label = "Any Author",
                    Options = Model.AvailableAuthors.Select(a => new AdminDropdownOption
                    {
                        Value = a,
                        Text = a,
                        Selected = a == Model.SelectedAuthor
                    }).ToList()
                }
            }
        };
    }
    <partial name="_AdminSearchBar" model="(searchConfig, Model.SelectedCategory ?? string.Empty)" />

    <!-- Book Inventory Section -->
    <main class="manage-books__inventory">
        <div class="manage-books__inventory-container">
            <div class="manage-books__inventory-header">
                <h2 class="manage-books__inventory-title">Book Inventory</h2>
            </div>

            <table class="manage-books__table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Author</th>
                        <th>Category</th>
                        <th>Quantity</th>
                        <th>Condition</th>
                        <th>Visible</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="books-list-container">
                    @Html.Partial("_BookInventoryRow", Model.Books)
                </tbody>
            </table>
        </div>
        <!-- Pagination Controls -->
        <div id="books-pagination"
             data-total-count="@ViewBag.TotalCount"
             data-page-size="@ViewBag.PageSize">
            <button class="pagination__btn" data-page="prev">Prev</button>
            <span id="pagination-current">1</span> / <span id="pagination-total">1</span>
            <button class="pagination__btn" data-page="next">Next</button>
        </div>
    </main>
</div>
