@model IEnumerable<HealingInWriting.Domain.Books.Book>

@{
    ViewData["Title"] = "Books for the Community";
}

@section Styles {
    <link rel="stylesheet" href="~/css/shared/page-hero.css" />
    <link rel="stylesheet" href="~/css/shared/search-bar.css" />
    <link rel="stylesheet" href="~/css/views/books.css" />
}

<main class="books">
    <!-- Hero Section with Title and Search -->
    <section class="page-hero">
        <div class="page-hero__content">
            <h1 class="page-hero__title">Books for the Community</h1>
            <p class="page-hero__subtitle">Browse and share books available in the community. Find what you need or give a book a new home.</p>
        </div>

        <!-- Reusable Search Bar Component -->
        <div class="search-bar">
            <!-- Search Input with Icon -->
            <div class="search-bar__input-container">
                <svg class="search-bar__icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none">
                    <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <input type="text" class="search-bar__input" placeholder="Search..." />
            </div>

            <!-- Any Tags Dropdown -->
            <div class="search-bar__dropdown">
                <span class="search-bar__dropdown-label">Any Tags</span>
                <svg class="search-bar__dropdown-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M6 9l6 6 6-6" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>

            <!-- Newest Dropdown -->
            <div class="search-bar__dropdown">
                <span class="search-bar__dropdown-label">Newest</span>
                <svg class="search-bar__dropdown-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M6 9l6 6 6-6" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>

            <!-- Search Button -->
            <button class="search-bar__button" type="button">
                <svg class="search-bar__button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span class="search-bar__button-label">Search</span>
            </button>
        </div>
    </section>

    <!-- Books List Section -->
    <section class="books__list-section">
        <div class="books__list-container">
            @if (Model?.Any() == true)
            {
                @foreach (var book in Model)
                {
                    <article class="book-card">
                        <div class="book-card__content">
                            <!-- Book Cover -->
                            <div class="book-card__cover">
                                @if (!string.IsNullOrEmpty(book.ImageLinks?.Thumbnail))
                                {
                                    <img src="@book.ImageLinks.Thumbnail" alt="@book.Title cover" />
                                }
                                else if (!string.IsNullOrEmpty(book.ImageLinks?.SmallThumbnail))
                                {
                                    <img src="@book.ImageLinks.SmallThumbnail" alt="@book.Title cover" />
                                }
                                else
                                {
                                    <img src="~/images/placeholder-book.svg" alt="Book cover placeholder" />
                                }
                            </div>

                            <!-- Book Information -->
                            <div class="book-card__info">
                                <div class="book-card__header">
                                    <h2 class="book-card__title">@book.Title</h2>
                                    
                                    <div class="book-card__meta">
                                        @if (book.Authors?.Any() == true)
                                        {
                                            <span class="book-card__meta-item">By @string.Join(", ", book.Authors)</span>
                                        }
                                        @if (!string.IsNullOrEmpty(book.PublishedDate))
                                        {
                                            <span class="book-card__meta-item">@book.PublishedDate</span>
                                        }
                                        @if (!string.IsNullOrEmpty(book.Publisher))
                                        {
                                            <span class="book-card__meta-item">@book.Publisher</span>
                                        }
                                        @if (book.PageCount > 0)
                                        {
                                            <span class="book-card__meta-item">@book.PageCount pages</span>
                                        }
                                    </div>
                                </div>

                                <div class="book-card__details">
                                    @if (book.Categories?.Any() == true)
                                    {
                                        <div class="book-card__tags">
                                            @foreach (var category in book.Categories.Take(3))
                                            {
                                                <span class="book-card__tag">
                                                    <span class="book-card__tag-text">@category</span>
                                                </span>
                                            }
                                        </div>
                                    }
                                </div>

                                @if (!string.IsNullOrEmpty(book.Description))
                                {
                                    <div class="book-card__description">
                                        <p class="book-card__description-text">@book.Description</p>
                                    </div>
                                }
                            </div>
                        </div>
                    </article>
                }
            }
            else
            {
                <div class="books__empty">
                    <p>No books available at the moment. Check back soon!</p>
                </div>
            }

            <!-- Load More Button -->
            <div class="books__load-more">
                <button class="books__load-more-button">Load More Books</button>
            </div>
        </div>
    </section>
</main>

@section Scripts {
    <script>
        // TODO: Implement search and filter functionality
        // TODO: Implement load more pagination
    </script>
}
