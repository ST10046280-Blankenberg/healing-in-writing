@model HealingInWriting.Models.Gallery.GalleryViewModel

@{
    ViewData["Title"] = "Gallery";
}

@section Styles {
    <link rel="stylesheet" href="~/css/shared/page-hero.css" />
    <link rel="stylesheet" href="~/css/views/gallery.css" asp-append-version="true" />
}

<main class="gallery">
    <!-- Hero Section -->
    <section class="page-hero">
        <div class="page-hero__content">
            <h1 class="page-hero__title">Gallery</h1>
            <p class="page-hero__subtitle">Browse and share books available in the community. Find what you need or give a book a new home.</p>
        </div>
    </section>

    <!-- Gallery Grid Section -->
    <section class="gallery__grid-section">
        <div class="gallery__grid-container">
            @if (Model.Photos.Any())
            {
                @foreach (var photo in Model.Photos)
                {
                    @if (photo.IsAlbum && photo.AlbumPhotoCount.HasValue)
                    {
                        <!-- Group Photo Card (with multi-photo indicator) -->
                        <article class="gallery-card gallery-card--group">
                            <img src="@photo.ImageUrl" alt="@photo.AltText" class="gallery-card__image" />
                            <div class="gallery-card__multi-indicator">
                                <svg class="gallery-card__multi-icon" xmlns="http://www.w3.org/2000/svg" width="38" height="38" viewBox="0 0 38 38" fill="none">
                                    <rect width="38" height="38" rx="4" fill="#F6FAF9"/>
                                    <rect x="0" y="0" width="32" height="32" rx="4" fill="#D9D9D9"/>
                                    <rect x="6" y="6" width="32" height="32" rx="4" fill="#D9D9D9"/>
                                    <rect x="2" y="2" width="32" height="32" rx="4" fill="#D9D9D9" stroke="#000000" stroke-width="2"/>
                                </svg>
                                <span class="gallery-card__photo-count">@photo.AlbumPhotoCount</span>
                            </div>
                        </article>
                    }
                    else
                    {
                        <!-- Single Photo Card -->
                        <article class="gallery-card gallery-card--single">
                            <img src="@photo.ImageUrl" alt="@photo.AltText" class="gallery-card__image" />
                        </article>
                    }
                }
            }
            else
            {
                <div class="gallery__empty-state" style="grid-column: 1 / -1; text-align: center; padding: 48px 24px;">
                    <p style="font-size: 1.25rem; color: #6b7280; margin-bottom: 16px;">No photos in the gallery yet.</p>
                    <p style="color: #9ca3af;">Check back soon for updates!</p>
                </div>
            }
        </div>
    </section>

    <!-- Pagination Section -->
    @if (Model.TotalPages > 1)
    {
        <section class="gallery__pagination-section">
            <div class="gallery__pagination-container">
                <nav class="gallery__pagination" aria-label="Gallery pagination">
                    @if (Model.HasPreviousPage)
                    {
                        <a href="@Url.Action("Index", new { page = Model.CurrentPage - 1, pageSize = Model.PageSize })" 
                           class="gallery__pagination-link gallery__pagination-link--prev" 
                           aria-label="Previous page">
                            ← Previous
                        </a>
                    }
                    
                    @for (int i = 1; i <= Model.TotalPages; i++)
                    {
                        @if (i == Model.CurrentPage)
                        {
                            <span class="gallery__pagination-link gallery__pagination-link--active" aria-current="page">@i</span>
                        }
                        else if (i == 1 || i == Model.TotalPages || (i >= Model.CurrentPage - 2 && i <= Model.CurrentPage + 2))
                        {
                            <a href="@Url.Action("Index", new { page = i, pageSize = Model.PageSize })" 
                               class="gallery__pagination-link">
                                @i
                            </a>
                        }
                        else if (i == Model.CurrentPage - 3 || i == Model.CurrentPage + 3)
                        {
                            <span class="gallery__pagination-ellipsis">...</span>
                        }
                    }
                    
                    @if (Model.HasNextPage)
                    {
                        <a href="@Url.Action("Index", new { page = Model.CurrentPage + 1, pageSize = Model.PageSize })" 
                           class="gallery__pagination-link gallery__pagination-link--next" 
                           aria-label="Next page">
                            Next →
                        </a>
                    }
                </nav>
                
                <div class="gallery__pagination-info">
                    Showing @((Model.CurrentPage - 1) * Model.PageSize + 1) - @Math.Min(Model.CurrentPage * Model.PageSize, Model.TotalCount) of @Model.TotalCount photos
                </div>
            </div>
        </section>
    }
</main>
