@model HealingInWriting.Models.Events.EventsListWithFiltersViewModel

@{
    ViewData["Title"] = "Events/Workshops for the Community";
}

@section Styles {
    <link rel="stylesheet" href="~/css/shared/page-hero.css" />
    <link rel="stylesheet" href="~/css/shared/search-bar.css" />
    <link rel="stylesheet" href="~/css/views/events.css" asp-append-version="true" />
}

<div class="events">
    <!-- Hero Section with Title and Search -->
    <section class="page-hero">
        <div class="page-hero__content">
            <h1 class="page-hero__title">Join Our Community Events & Workshops</h1>
            <p class="page-hero__subtitle">Discover opportunities to connect, learn, and grow with others.</p>
        </div>

        <!-- Reusable Search Bar Component -->
        <!-- Reusable Search and Filter Bar -->
        <partial name="_SearchAndFilterBar" model="Model.Filter" />
    </section>

    <!-- Body Section with Event/Workshop Cards -->
    <!-- Events List Section -->
    <section class="events__body">
        <div class="events__grid">
            @if (!Model.EventsList.Events.Any())
            {
                <div style="grid-column: 1 / -1; text-align: center; padding: 3rem;">
                    <h3>No published events available</h3>
                    <p>Check back soon for upcoming events and workshops.</p>
                </div>
            }
            else
            {
                @foreach (var eventItem in Model.EventsList.Events)
                {
                    var badgeClass = eventItem.EventType == HealingInWriting.Domain.Events.EventType.Workshop
                    ? "event-card__badge--workshop"
                    : "event-card__badge--community";
                    var badgeLabel = eventItem.EventType.ToString();
                    var eventDate = eventItem.StartDateTime.ToString("MMM dd, yyyy");
                    var eventTime = eventItem.StartDateTime.ToString("h:mm tt");
                    var description = eventItem.Description.Length > 150
                    ? eventItem.Description.Substring(0, 150) + "..."
                    : eventItem.Description;

                    <article class="event-card">
                        <img src="@eventItem.CoverImageUrl" alt="@eventItem.Title" class="event-card__image" />
                        <div class="event-card__content">
                            <span class="event-card__badge @badgeClass">@badgeLabel</span>
                            <h2 class="event-card__title">@eventItem.Title</h2>
                            <div class="event-card__meta">
                                <div class="event-card__meta-item">
                                    <svg class="event-card__icon" xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16" fill="none">
                                        <path d="M11 2H3C1.89543 2 1 2.89543 1 4V14C1 15.1046 1.89543 16 3 16H11C12.1046 16 13 15.1046 13 14V4C13 2.89543 12.1046 2 11 2Z" stroke="#4B5563" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                        <path d="M10 0V4M4 0V4M1 8H13" stroke="#4B5563" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                    </svg>
                                    <span class="event-card__meta-text">@eventDate</span>
                                </div>
                                <div class="event-card__meta-item">
                                    <svg class="event-card__icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
                                        <circle cx="8" cy="8" r="7" stroke="#4B5563" stroke-width="2" />
                                        <path d="M8 4V8L11 11" stroke="#4B5563" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                    </svg>
                                    <span class="event-card__meta-text">@eventTime</span>
                                </div>
                            </div>
                            <p class="event-card__description-text">@description</p>
                            <a asp-area="" asp-controller="Events" asp-action="Details" asp-route-id="@eventItem.Id" class="btn btn--primary">View More</a>
                        </div>
                    </article>
                }
            }
        </div>

        <!-- Load More Button (TODO: Implement pagination) -->
        @if (Model.EventsList.Events.Any())
        {
            <div class="events__load-more">
                <button class="btn btn--secondary" type="button" disabled>Load More Events</button>
            </div>
        }
    </section>
</div>
